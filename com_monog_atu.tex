\documentclass[a4paper,paratype,12pt,fouriernc]{cmonogra}
% atutext dejavu droid paratype fouriernc

\usepackage[verbose,dvips,a4paper,tmargin=20mm,bmargin=25mm,lmargin=20mm,rmargin=20mm,headsep=4pt,includeheadfoot]{geometry}


%\input{commonsetup.tex}
\usepackage[backend=biber,sorting=none,maxnames=100,bibstyle=gost-numeric]{biblatex}

\input{tikzsetup.tex}

\setstretch{1.2}

\input{defs.tex}

\title{\bookname}
\author{Коллективный автор}

\addbibresource{atuworks.bib}
\addbibresource{artrefs.bib}

\hypersetup{
  pdftitle={\thetitle},
  pdfauthor={\theauthor},
  colorlinks=true,
  linkcolor=blue,
  citecolor=brown
}

%\newcommand{\LinkRef}[1]{ \textit{\color{red}#1} }
\newcommand{\LinkRef}[1]{}
% \newcommand{\Cmt}[1]{ {\small\color{red}#1} }
\newcommand{\Cmt}[1]{}


\pagestyle{stheadings}

% ====================================================================================================
\begin{document}

\tableofcontents


% ----------------------------------------------------------------------------------------------------
\MonoArticle{atu}{Оценивание эффективности применения интегральных критериев в задачах параметрической идентификации хаотических систем}{А.И.~Гуда, А.И.~Михалёв}{Гуда~А.И., Михалёв~А.И.}

\subsection*{Введение}

Синтез систем идентификации для сложных нелинейных динамических систем
был и остаётся сложной задачей. Невозможность определения
аналитической зависимости значений идентифицируемых параметров
от выхода объекта делает неработоспособными большинство известных
методов идентификации. Наибольшую сложность для идентификации
представляют системы динамического хаоса~\cite{moon_chaotic_vibr,anisch_nonlin_eff,sprott_212}.
Даже лучшие в своем классе, методы адаптивно-поисковой идентификации, % TODO: ref
в чистом виде оказываются в данном случае неработоспособными.
Успешность построения системы идентификации для хаотических
систем определяется наличием интегрального критерия,
учитывающего динамику системы и зависящего от идентифицируемых параметров.


\subsection*{Критерии идентификации}

Как уже было отмечено, для успешности процесса идентификации требуется
построение различных интегральных критериев, зависящих,
хотя бы в первом приближении
от величины идентифицируемого параметра. Конкретный вид определяется самим идентифицируемым
объектом. При этом, довольно часто (но не всегда) в качестве основы для такого критерия выступает
некая энергетическая зависимость. С учётом усреднения на требуемом интервале,
один из простых видов критерия может быть задан как

\begin{equation}
\od{q_{x^2}}{t}
=
\frac{1}{\tau} \left( x^2(t) - q_{x^2}(t) \right)
,
\label{atu:eq:q}
\end{equation}

\noindent
где $\tau$ -- характерное время оценивания, $x(t)$ -- выбранная переменная состояния системы.
Это далеко не единственный вид определения критерия, но в данной работе предлагается именно он,
и последующие критерием будут использовать (\ref{atu:eq:q}).

\subsection*{Мультимодельные методы идентификации}

Процесс поисковой идентификации заключается в настройке параметров одной
или нескольких моделей, анализу критериев идентификации
(или соответствующих функций качества), и оцениванию по этой информации
значения идентифицируемого параметра. При использовании в целях идентификации нескольких моделей,
появляются общие действия, применяемые к каждой из них.

Рассмотрим одномерный случай.
Пусть задан объект $ \mathbf{O} $, и $N$ моделей:
$ \mathbf{M}_0 \ldots \mathbf{M}_{N-1} $.
На вход как объекта, так и каждой из моделей подаётся (при необходимости)
входной сигнал $u(t)$. Выход моделей $x_{mi}(t)$ измеряется точно,
а объекта $x_o(t)$ -- с определённой, наперёд неизвестной помехой $w(t)$. При необходимости искусственную помеху
со сходными характеристиками можно подмешивать и к выходу моделей.
Обозначим $q_o(t)$ -- текущее значение критерия для
объекта, $q_{mi}(t)$ -- для $i$-той модели.
Соответственно $p_o(t)$ -- значение параметра для объекта,
$p_{mi}(t)$ -- для $i$-той модели.


Определение: \textbf{поисковый агент} -- это динамическая система, получающая выходной ($x(t)$),
и, при необходимости входной сигнал ($u(t)$) от одной или нескольких моделей,
может быть информацию от других поисковых агентов,
на основании значения критерия идентификации
реализующая алгоритм настройки параметра модели (моделей)
таким образом, чтобы обеспечить идентификацию заданного параметра.

Один поисковый агент может управлять как одной моделью (рис.~\ref{atu:f:agent1}),
так и несколькими. При этом
он может использовать информацию, как полученную как от других
агентов, так и полученную в результате обработки данных на других уровнях системы идентификации.

\begin{figure}[htb!]
\begin{center}
\input{p/agent1.pgf}
\end{center}
\caption{Поисковый агент, настраивающий параметр одной модели}
\label{atu:f:agent1}
\end{figure}


В случае, когда один агент настраивает несколько моделей,
или/и, если пространство параметров имеет размерность больше единицы,
вместо простого индекса $i$ могут применяется составные.

В простейших случаях возможно построение системы идентификации
с одной моделью, и соответственно одним поисковым агентом.
Примерами такого похода могут служить
метод синхронного детектора \cite{adopt_cont_sys}
и оригинальный адаптивно-поисковый метод \cite{mich_92}.
Применение одномодельных методов требует определённого механизма
сохранения истории процесса поиска, по крайней мере в пределах
одного поискового ``периода''. Это сильно ограничивает диапазон
применимости данных методов, в первую очередь -- из-за значительных
временных затрат на повторяющийся поиск.

Применение пары моделей \cite{atu_asau3}
(в этом случае имеет смысл говорить об одном поисковом агенте)
позволяет с меньшими временными затратами оценить градиент функции качества,
и, как следствие -- определить значение параметра. Также значительным плюсом
такого подхода является меньшая скорость изменения параметров моделей.

Тем не менее, при использовании пары моделей неоправданно много времени
тратится на перемещение поисковой пары, особенно при резких изменениях
идентифицируемого параметра. Поэтому, использование множества
поисковых агентов может кардинально уменьшить время идентификации.

Каждый поисковый агент, определяя величину $q_{mi}(t)$ , и получая $q_o(t)$,
вычисляет безразмерную функцию качества идентификации
$F(q_o,q_m)$.

С учётом обозначения

\[
  q_r = \frac{q_o - q_m}{q_\gamma},
\]

\noindent
представлены наиболее распространённые виды таких функций:

\begin{equation}
  F_{\mathrm{gauss}} = \exp( - q_r^2 ),
\label{atu:eq:F_gauss}
\end{equation}

\begin{equation}
  F_{\mathrm{parabolic}} = 1 - q_r^2 \left( 1 - \frac{1}{e} \right),
\label{atu:eq:F_parabolic}
\end{equation}

\begin{equation}
  F_{\mathrm{triangle}} = 1 - |q_r| \left( 1 - \frac{1}{e} \right),
\label{atu:eq:F_triangle}
\end{equation}

\begin{equation}
  F_{\mathrm{hyper}} = \frac{1}{ 1 + |q_r| \left( 1 - \frac{1}{e} \right)},
\label{atu:eq:F_hyper}
\end{equation}

\begin{equation}
  F_{\mathrm{log}} = 1 - \ln \left( 1 + |q_r| \right) \frac{1-1/e}{\ln(2)}.
\label{atu:eq:F_log}
\end{equation}

Для всех рассмотренных функций $q_\gamma$ -- величина, обратная чувствительности
функции качества, задаёт масштаб и рабочий диапазон функции качества (рис.~\ref{atu:f:F_types}).
При этом, при необходимости, значения этих функций могут быть искусственно ограничены диапазоном $[0;1]$.
Каждая имеет свой набор преимуществ и недостатков~\cite{atu_ISDMCI2016}. В данной работе используется
функция (\ref{atu:eq:F_gauss}).

\begin{figure}[htb!]
  \centerline{\includegraphics[width=45\TW]{p/F_types.png} }
  \caption{Функции качества идентификации (\ref{atu:eq:F_gauss})--(\ref{atu:eq:F_log})}
  \label{atu:f:F_types}
\end{figure}

Рассмотрим случай, когда каждый агент взаимодействует с двумя своими ближайшими соседями,
запрашивая у них величины $p$ -- текущее значение параметра и $F$.
При анализе конкретного агента, для упрощения записи, его индекс $i$ обозначим как ``c'' (current),
предыдущий получает индекс ``l'' (left), а последующий -- ``r'' (right).
Для единообразия дополним множество моделей двумя неподвижными псевдомоделями (fake models),
обозначив их индексами ``ll'' и ``rr''. Для псевдомоделей считаем $  F_{ll} = F_{rr} = 0$,
а координаты выбираются за пределами рабочего диапазона поиска.


Рассмотрим 3 подхода к определению
точки максимума функции качества, а следовательно -- значения идентифицируемого параметра \cite{atu_st99,atu_jacs2015}.
Первый -- реализация
метода COG (Center of gravity, Такаги-Сугено) \cite{atu_asau25,atu_csit2015},
используемого при дефаззификации систем нечёткой логики:

\begin{equation}
  p_{ge}
  =
  \frac{\sum\limits_{i=0}^{n-1} F_{mi} p_{mi}}
       {\sum\limits_{i=0}^{n-1} F_{mi} }
  .
  \label{atu:eq:p_ge}
\end{equation}

Второй подход призван уменьшить зависимость первого
от влияния локальных экстремумов и границ. В этом
случае определяется модель $M_{i_{m}}$ с максимальным значением
$F$, а в оценке используется только ближайшая окрестность этой модели:

\begin{equation}
  p_{le}
  =
  \frac{ F_{i_m-1} p_{i_m-1} + F_{i_m} p_{i_m} + F_{i_m+1} p_{i_m+1} }
       { F_{i_m-1} + F_{i_m} + F_{i_m+1} }
  .
  \label{atu:eq:p_le}
\end{equation}

Третий подход отличается от второго тем, что по трём точкам вблизи  $M_{i_{m}}$
функция $F(p)$ аппроксимируется параболой, и абсцисса её вершины задаёт искомое
значение параметра. Сместим начало координат в точку
$ ( p_c, F_c ) $. Тогда

\[
  \tilde{p}_c = 0, \,
  \tilde{p}_l = p_l - p_c, \,
  \tilde{p}_r = p_r - p_c.
\]

\[
  \tilde{F}_c = 0, \,
  \tilde{F}_l = F_l - F_c, \,
  \tilde{F}_r = F_r - F_c.
\]

\[
  \left\{
    \begin{array}{l}
      a_2 \tilde{p}_l^2 + a_1 \tilde{p}_l  = \tilde{F}_l
      \\
      a_2 \tilde{p}_r^2 + a_1 \tilde{p}_r  = \tilde{F}_r
    \end{array}
  \right. .
\]

\[
  a_1 = \frac{\tilde{F}_r \tilde{p}_l^2 - \tilde{F}_l \tilde{p}_r^2 }
             { \tilde{p}_l^2 \tilde{p}_r  + \tilde{p}_l \tilde{p}_r^2 }.
\]

\[
  a_2 = \frac{\tilde{F}_r \tilde{p}_l - \tilde{F}_l \tilde{p}_r }
             { \tilde{p}_l^2 \tilde{p}_r  + \tilde{p}_l \tilde{p}_r^2 }.
\]

\begin{equation}
  \tilde{p}_e = - \frac{a_1}{2 a_2};
  \;
  p_e = p_c -- \frac{a_1}{2 a_2}.
  \label{atu:eq:p_e}
\end{equation}


При этом, если
$ p_e \notin [ p_l, p_r ] $, или $ a_2 \ge 0 $, то значение $p_e$ искусственно
ограничивается этим диапазоном. Значение $p_e$ для модели с индексом
$i_m$ обозначим как $p_{ee}$ и будем считать
текущим значением идентифицируемого параметра, полученным с помощью
третьего подхода. Ошибки идентификации в пространстве параметров
для рассмотренных трёх подходов обозначим соответственно:

\begin{equation}
  e_{ge} = p_{ge} - p_o, \;
  e_{le} = p_{le} - p_o, \;
  e_{ee} = p_{ee} - p_o.
  \label{atu:eq:e_xx}
\end{equation}


Динамика изменения параметров моделей (поисковых агентов) задаётся следующим образом:

\begin{equation}
  \od{p_c}{t} = v_f f_t(t),
  \label{atu:eq:dp_dt}
\end{equation}

\noindent
где $f_t$ -- сумма всех действующих ``сил'', $v_f$ -- коэффициент
пропорциональности. Рассмотрим 3 действующие силы
($ f_t = f_c + f_n + f_e $):

\begin{enumerate}
  \item
    $f_c = -k_c (p_c - p_{c,0}) $ -- ``сила притяжения'' к начальному значению
    параметра
    для данной модели. Наличие этой силы не даёт всем моделям принять одно
    и то же значение параметра вблизи экстремума, и, следовательно,
    прекратить процесс поиска. Это также позволяет быстро переключиться
    на другую модель в случае быстрого изменения параметра объекта.

  \item
    $f_n = k_n ( p_r - 2 p_c + p_l ) $ -- ``сила взаимодействия''
    с соседями. Обеспечивает более равномерное распределение
    параметров моделей вблизи экстремума.

  \item
    $f_e = - k_e ( p_c - p_e ) $ -- ``сила притяжения'' к локальной
    оценке экстремума, определённого по выражению~(\ref{atu:eq:p_e}).

\end{enumerate}

Результаты моделирования показали, что в некоторых случаях
имеет смысл введение дополнительных сил ``барьерного'' вида,
для исключения пересечения траекторий поисковых агентов, или же их ухода из рабочего диапазона.



Для определения как точности, так и скорости работы системы
идентификации, при моделировании процесса идентификации
значения идентифицируемого параметра задавались следующими образами:

\begin{equation}
  p_o(t) = p_0 +  U_{p} \sin( \omega_{p} t ),
  \label{atu:eq:p_sin}
\end{equation}

\begin{equation}
  p_o(t) = p_0 + U_{p} \sign \sin( \omega_{p} t ).
  \label{atu:eq:p_sign}
\end{equation}

При этом измерялись среднеквадратические ошибки идентификации,
что позволило исследовать применимость систем идентификации
при различной динамике изменения параметров, а также
настроить параметры самой системы идентификации.

Для моделирования как рассматриваемых идентифицируемых систем,
так и динамики процессов идентификации использовалась разработанное
программное средство ``qontrol''.


\subsection*{Тестовые хаотические системы }

% \input{lor_testsys.tex} % unfilled, but is near to good

% \input{duff_testsys.tex}

\input{chua_testsys.tex} % good

% \input{ross_testsys.tex} % ??

% \input{vdp_testsys.tex} % ??

\input{colp_testsys.tex} % good

% \input{deadvi_testsys.tex} %

\input{spr_a_testsys.tex} % good

\input{fric_testsys.tex}  % good

% \input{relax_testsys.tex} % no id

% \input{vglass_testsys.tex} %



\subsection*{Выводы}

В целом, применение рассмотренных видов критериев, в совокупности
с мультимодельными (мультиагентными) методами поисковой идентификации
оказалось продуктивным, и показало их
работоспособность для рассмотренных хаотических, и в какой-то мере эквивалентным им
сложных динамических систем.



Для большинства из рассмотренных систем вид критерия
был получен практически автоматически, из анализа полученных
в результате моделирования зависимостей, имеющих прямое или косвенное отношение
к энергетическим параметрам. Для системы с сухим трением,
синтез критерия был основан на явных физических зависимостях.
Созданные критерии позволяют реализовать процесс идентификации для случаев
сложной или же хаотической динамики,
когда полностью отсутствуют хоть какая-нибудь информация о
трендовом поведении объекта, и невозможно получить аналитическую
или же статистическую связь между параметрами и выходом системы.

Одновременная настройка параметров нескольких моделей ансамблем поисковых агентов
позволила максимально преодолеть противоречие между скоростью и точностью
идентификации. При таком подходе время идентификации определяется
временем реакции идентифицируемой системы на изменение параметра.
Для систем со сложной, а тем более хаотической динамикой это время достигает
значительных величин, по сравнению с характерными временами самой динамики системы.


Полученные зависимости ошибок идентификации от параметров
самой системы идентификации, с одной стороны, позволяют
правильно настроить эти параметры для получения максимально быстрой
и точной идентификации. С другой стороны, эти зависимости
характеризуют связь свойств идентифицируемого объекта с
требуемыми качествами самой системы идентификации.


\printbibliography
\label{e:atu}{~}

\FloatBarrier


\end{document}

